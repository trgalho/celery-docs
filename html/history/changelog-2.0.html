<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Change history for Celery 2.0 &#8212; Celery 3.1.25 documentation</title>
    
    <link rel="stylesheet" href="../_static/celery.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.1.25',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="Change history for Celery 1.0" href="changelog-1.0.html" />
    <link rel="prev" title="Change history for Celery 2.1" href="changelog-2.1.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="changelog-1.0.html" title="Change history for Celery 1.0"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="changelog-2.1.html" title="Change history for Celery 2.1"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Celery 3.1.25 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">History</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
<div class="deck">

    
        <p>
        This document describes the current stable version of Celery (3.1). For development docs,
        <a href="http://docs.celeryproject.org/en/master/history/changelog-2.0.html">go here</a>.
        </p>
    

</div>
    <div class="section" id="change-history-for-celery-2-0">
<span id="changelog-2-0"></span><h1>Change history for Celery 2.0<a class="headerlink" href="#change-history-for-celery-2-0" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#version-2-0-3" id="id5">2.0.3</a><ul>
<li><a class="reference internal" href="#fixes" id="id6">Fixes</a></li>
<li><a class="reference internal" href="#documentation" id="id7">Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-0-2" id="id8">2.0.2</a></li>
<li><a class="reference internal" href="#version-2-0-1" id="id9">2.0.1</a></li>
<li><a class="reference internal" href="#version-2-0-0" id="id10">2.0.0</a><ul>
<li><a class="reference internal" href="#foreword" id="id11">Foreword</a></li>
<li><a class="reference internal" href="#upgrading-for-django-users" id="id12">Upgrading for Django-users</a></li>
<li><a class="reference internal" href="#upgrading-for-others" id="id13">Upgrading for others</a><ul>
<li><a class="reference internal" href="#database-result-backend" id="id14">Database result backend</a></li>
<li><a class="reference internal" href="#cache-result-backend" id="id15">Cache result backend</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backward-incompatible-changes" id="id16">Backward incompatible changes</a></li>
<li><a class="reference internal" href="#news" id="id17">News</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="version-2-0-3">
<span id="id1"></span><h2><a class="toc-backref" href="#id5">2.0.3</a><a class="headerlink" href="#version-2-0-3" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-08-27 12:00 P.M CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<div class="section" id="fixes">
<span id="v203-fixes"></span><h3><a class="toc-backref" href="#id6">Fixes</a><a class="headerlink" href="#fixes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Worker: Properly handle connection errors happening while
closing consumers.</p>
</li>
<li><p class="first">Worker: Events are now buffered if the connection is down,
then sent when the connection is re-established.</p>
</li>
<li><p class="first">No longer depends on the <code class="xref py py-mod docutils literal"><span class="pre">mailer</span></code> package.</p>
<blockquote>
<div><p>This package had a name space collision with <cite>django-mailer</cite>,
so its functionality was replaced.</p>
</div></blockquote>
</li>
<li><p class="first">Redis result backend: Documentation typos: Redis doesn&#8217;t have
database names, but database numbers. The default database is now 0.</p>
</li>
<li><p class="first"><code class="xref py py-class docutils literal"><span class="pre">inspect</span></code>:
<cite>registered_tasks</cite> was requesting an invalid command because of a typo.</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/170"><span class="xref issue">issue #170</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first"><a class="reference internal" href="../configuration.html#std:setting-CELERY_ROUTES"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_ROUTES</span></code></a>: Values defined in the route should now have
precedence over values defined in <a class="reference internal" href="../configuration.html#std:setting-CELERY_QUEUES"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_QUEUES</span></code></a> when merging
the two.</p>
<blockquote>
<div><p>With the follow settings:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">CELERY_QUEUES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cpubound&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;exchange&quot;</span><span class="p">:</span> <span class="s2">&quot;cpubound&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;routing_key&quot;</span><span class="p">:</span> <span class="s2">&quot;cpubound&quot;</span><span class="p">}}</span>

<span class="n">CELERY_ROUTES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;tasks.add&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;queue&quot;</span><span class="p">:</span> <span class="s2">&quot;cpubound&quot;</span><span class="p">,</span>
                               <span class="s2">&quot;routing_key&quot;</span><span class="p">:</span> <span class="s2">&quot;tasks.add&quot;</span><span class="p">,</span>
                               <span class="s2">&quot;serializer&quot;</span><span class="p">:</span> <span class="s2">&quot;json&quot;</span><span class="p">}}</span>
</pre></div>
</div>
<p>The final routing options for <cite>tasks.add</cite> will become:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;exchange&quot;</span><span class="p">:</span> <span class="s2">&quot;cpubound&quot;</span><span class="p">,</span>
 <span class="s2">&quot;routing_key&quot;</span><span class="p">:</span> <span class="s2">&quot;tasks.add&quot;</span><span class="p">,</span>
 <span class="s2">&quot;serializer&quot;</span><span class="p">:</span> <span class="s2">&quot;json&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>This was not the case before: the values
in <a class="reference internal" href="../configuration.html#std:setting-CELERY_QUEUES"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_QUEUES</span></code></a> would take precedence.</p>
</div></blockquote>
</li>
<li><p class="first">Worker crashed if the value of <code class="xref std std-setting docutils literal"><span class="pre">CELERY_TASK_ERROR_WHITELIST</span></code> was
not an iterable</p>
</li>
<li><p class="first"><code class="xref py py-func docutils literal"><span class="pre">apply()</span></code>: Make sure <cite>kwargs[&#8220;task_id&#8221;]</cite> is
always set.</p>
</li>
<li><p class="first"><cite>AsyncResult.traceback</cite>: Now returns <code class="xref py py-const docutils literal"><span class="pre">None</span></code>, instead of raising
<a class="reference external" href="https://docs.python.org/dev/library/exceptions.html#KeyError" title="(in Python v3.11)"><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code></a> if traceback is missing.</p>
</li>
<li><p class="first"><code class="xref py py-class docutils literal"><span class="pre">inspect</span></code>: Replies did not work correctly
if no destination was specified.</p>
</li>
<li><p class="first">Can now store result/metadata for custom states.</p>
</li>
<li><p class="first">Worker: A warning is now emitted if the sending of task error
emails fails.</p>
</li>
<li><p class="first">celeryev: Curses monitor no longer crashes if the terminal window
is resized.</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/160"><span class="xref issue">issue #160</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">Worker: On OS X it is not possible to run <cite>os.exec*</cite> in a process
that is threaded.</p>
<blockquote>
<div><blockquote>
<div><p>This breaks the SIGHUP restart handler,
and is now disabled on OS X, emitting a warning instead.</p>
</div></blockquote>
<p>See <a class="reference external" href="https://github.com/celery/celery/issues/152"><span class="xref issue">issue #152</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="xref py py-mod docutils literal"><span class="pre">celery.execute.trace</span></code>: Properly handle <cite>raise(str)</cite>,
which is still allowed in Python 2.4.</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/175"><span class="xref issue">issue #175</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">Using urllib2 in a periodic task on OS X crashed because
of the proxy auto detection used in OS X.</p>
<blockquote>
<div><p>This is now fixed by using a workaround.
See <a class="reference external" href="https://github.com/celery/celery/issues/143"><span class="xref issue">issue #143</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">Debian init scripts: Commands should not run in a sub shell</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/163"><span class="xref issue">issue #163</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">Debian init scripts: Use the absolute path of celeryd program to allow stat</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/162"><span class="xref issue">issue #162</span></a>.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="documentation">
<span id="v203-documentation"></span><h3><a class="toc-backref" href="#id7">Documentation</a><a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">getting-started/broker-installation: Fixed typo</p>
<blockquote>
<div><p><cite>set_permissions &#8220;&#8221;</cite> -&gt; <cite>set_permissions &#8221;.*&#8221;</cite>.</p>
</div></blockquote>
</li>
<li><p class="first">Tasks User Guide: Added section on database transactions.</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/169"><span class="xref issue">issue #169</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">Routing User Guide: Fixed typo <cite>&#8220;feed&#8221;: -&gt; {&#8220;queue&#8221;: &#8220;feeds&#8221;}</cite>.</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/169"><span class="xref issue">issue #169</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">Documented the default values for the <a class="reference internal" href="../configuration.html#std:setting-CELERYD_CONCURRENCY"><code class="xref std std-setting docutils literal"><span class="pre">CELERYD_CONCURRENCY</span></code></a>
and <a class="reference internal" href="../configuration.html#std:setting-CELERYD_PREFETCH_MULTIPLIER"><code class="xref std std-setting docutils literal"><span class="pre">CELERYD_PREFETCH_MULTIPLIER</span></code></a> settings.</p>
</li>
<li><p class="first">Tasks User Guide: Fixed typos in the subtask example</p>
</li>
<li><p class="first">celery.signals: Documented worker_process_init.</p>
</li>
<li><p class="first">Daemonization cookbook: Need to export DJANGO_SETTINGS_MODULE in
<cite>/etc/default/celeryd</cite>.</p>
</li>
<li><p class="first">Added some more FAQs from stack overflow</p>
</li>
<li><p class="first">Daemonization cookbook: Fixed typo <cite>CELERYD_LOGFILE/CELERYD_PIDFILE</cite></p>
<blockquote>
<div><p>to <cite>CELERYD_LOG_FILE</cite> / <cite>CELERYD_PID_FILE</cite></p>
<p>Also added troubleshooting section for the init scripts.</p>
</div></blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="version-2-0-2">
<span id="id2"></span><h2><a class="toc-backref" href="#id8">2.0.2</a><a class="headerlink" href="#version-2-0-2" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-07-22 11:31 A.M CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Routes: When using the dict route syntax, the exchange for a task
could disappear making the task unroutable.</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/158"><span class="xref issue">issue #158</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">Test suite now passing on Python 2.4</p>
</li>
<li><p class="first">No longer have to type <cite>PYTHONPATH=.</cite> to use celeryconfig in the current
directory.</p>
<blockquote>
<div><p>This is accomplished by the default loader ensuring that the current
directory is in <cite>sys.path</cite> when loading the config module.
<cite>sys.path</cite> is reset to its original state after loading.</p>
<p>Adding the current working directory to <cite>sys.path</cite> without the user
knowing may be a security issue, as this means someone can drop a Python module in the users
directory that executes arbitrary commands. This was the original reason
not to do this, but if done <em>only when loading the config module</em>, this
means that the behavior will only apply to the modules imported in the
config module, which I think is a good compromise (certainly better than
just explicitly setting <cite>PYTHONPATH=.</cite> anyway)</p>
</div></blockquote>
</li>
<li><p class="first">Experimental Cassandra backend added.</p>
</li>
<li><p class="first">Worker: SIGHUP handler accidentally propagated to worker pool processes.</p>
<blockquote>
<div><p>In combination with 7a7c44e39344789f11b5346e9cc8340f5fe4846c
this would make each child process start a new worker instance when
the terminal window was closed :/</p>
</div></blockquote>
</li>
<li><p class="first">Worker: Do not install SIGHUP handler if running from a terminal.</p>
<blockquote>
<div><p>This fixes the problem where the worker is launched in the background
when closing the terminal.</p>
</div></blockquote>
</li>
<li><p class="first">Worker: Now joins threads at shutdown.</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/152"><span class="xref issue">issue #152</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">Test tear down: Don&#8217;t use <cite>atexit</cite> but nose&#8217;s <cite>teardown()</cite> functionality
instead.</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/154"><span class="xref issue">issue #154</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">Debian worker init script: Stop now works correctly.</p>
</li>
<li><p class="first">Task logger: <cite>warn</cite> method added (synonym for <cite>warning</cite>)</p>
</li>
<li><p class="first">Can now define a white list of errors to send error emails for.</p>
<blockquote>
<div><p>Example:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">CELERY_TASK_ERROR_WHITELIST</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;myapp.MalformedInputError&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://github.com/celery/celery/issues/153"><span class="xref issue">issue #153</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">Worker: Now handles overflow exceptions in <cite>time.mktime</cite> while parsing
the ETA field.</p>
</li>
<li><p class="first">LoggerWrapper: Try to detect loggers logging back to stderr/stdout making
an infinite loop.</p>
</li>
<li><p class="first">Added <code class="xref py py-class docutils literal"><span class="pre">celery.task.control.inspect</span></code>: Inspects a running worker.</p>
<blockquote>
<div><p>Examples:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="c1"># Inspect a single worker</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">inspect</span><span class="p">(</span><span class="s2">&quot;myworker.example.com&quot;</span><span class="p">)</span>

<span class="c1"># Inspect several workers</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">inspect</span><span class="p">([</span><span class="s2">&quot;myworker.example.com&quot;</span><span class="p">,</span> <span class="s2">&quot;myworker2.example.com&quot;</span><span class="p">])</span>

<span class="c1"># Inspect all workers consuming on this vhost.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">inspect</span><span class="p">()</span>

<span class="c1">### Methods</span>

<span class="c1"># Get currently executing tasks</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">i</span><span class="o">.</span><span class="n">active</span><span class="p">()</span>

<span class="c1"># Get currently reserved tasks</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">i</span><span class="o">.</span><span class="n">reserved</span><span class="p">()</span>

<span class="c1"># Get the current eta schedule</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">i</span><span class="o">.</span><span class="n">scheduled</span><span class="p">()</span>

<span class="c1"># Worker statistics and info</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">i</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>

<span class="c1"># List of currently revoked tasks</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">i</span><span class="o">.</span><span class="n">revoked</span><span class="p">()</span>

<span class="c1"># List of registered tasks</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">i</span><span class="o">.</span><span class="n">registered_tasks</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Remote control commands <cite>dump_active</cite>/<cite>dump_reserved</cite>/<cite>dump_schedule</cite>
now replies with detailed task requests.</p>
<blockquote>
<div><p>Containing the original arguments and fields of the task requested.</p>
<p>In addition the remote control command <cite>set_loglevel</cite> has been added,
this only changes the log level for the main process.</p>
</div></blockquote>
</li>
<li><p class="first">Worker control command execution now catches errors and returns their
string representation in the reply.</p>
</li>
<li><p class="first">Functional test suite added</p>
<blockquote>
<div><p><code class="xref py py-mod docutils literal"><span class="pre">celery.tests.functional.case</span></code> contains utilities to start
and stop an embedded worker process, for use in functional testing.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="version-2-0-1">
<span id="id3"></span><h2><a class="toc-backref" href="#id9">2.0.1</a><a class="headerlink" href="#version-2-0-1" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-07-09 03:02 P.M CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">multiprocessing.pool: Now handles encoding errors, so that pickling errors
doesn&#8217;t crash the worker processes.</p>
</li>
<li><p class="first">The remote control command replies was not working with RabbitMQ 1.8.0&#8217;s
stricter equivalence checks.</p>
<blockquote>
<div><p>If you&#8217;ve already hit this problem you may have to delete the
declaration:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ camqadm exchange.delete celerycrq
</pre></div>
</div>
<p>or:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ python manage.py camqadm exchange.delete celerycrq
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">A bug sneaked in the ETA scheduler that made it only able to execute
one task per second(!)</p>
<blockquote>
<div><p>The scheduler sleeps between iterations so it doesn&#8217;t consume too much CPU.
It keeps a list of the scheduled items sorted by time, at each iteration
it sleeps for the remaining time of the item with the nearest deadline.
If there are no eta tasks it will sleep for a minimum amount of time, one
second by default.</p>
<p>A bug sneaked in here, making it sleep for one second for every task
that was scheduled. This has been fixed, so now it should move
tasks like hot knife through butter.</p>
<p>In addition a new setting has been added to control the minimum sleep
interval; <code class="xref std std-setting docutils literal"><span class="pre">CELERYD_ETA_SCHEDULER_PRECISION</span></code>. A good
value for this would be a float between 0 and 1, depending
on the needed precision. A value of 0.8 means that when the ETA of a task
is met, it will take at most 0.8 seconds for the task to be moved to the
ready queue.</p>
</div></blockquote>
</li>
<li><p class="first">Pool: Supervisor did not release the semaphore.</p>
<blockquote>
<div><p>This would lead to a deadlock if all workers terminated prematurely.</p>
</div></blockquote>
</li>
<li><p class="first">Added Python version trove classifiers: 2.4, 2.5, 2.6 and 2.7</p>
</li>
<li><p class="first">Tests now passing on Python 2.7.</p>
</li>
<li><p class="first">Task.__reduce__: Tasks created using the task decorator can now be pickled.</p>
</li>
<li><p class="first">setup.py: nose added to <cite>tests_require</cite>.</p>
</li>
<li><p class="first">Pickle should now work with SQLAlchemy 0.5.x</p>
</li>
<li><p class="first">New homepage design by Jan Henrik Helmers: <a class="reference external" href="http://celeryproject.org">http://celeryproject.org</a></p>
</li>
<li><p class="first">New Sphinx theme by Armin Ronacher: <a class="reference external" href="http://docs.celeryproject.org/">http://docs.celeryproject.org/</a></p>
</li>
<li><p class="first">Fixed &#8220;pending_xref&#8221; errors shown in the HTML rendering of the
documentation. Apparently this was caused by new changes in Sphinx 1.0b2.</p>
</li>
<li><p class="first">Router classes in <a class="reference internal" href="../configuration.html#std:setting-CELERY_ROUTES"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_ROUTES</span></code></a> are now imported lazily.</p>
<blockquote>
<div><p>Importing a router class in a module that also loads the Celery
environment would cause a circular dependency. This is solved
by importing it when needed after the environment is set up.</p>
</div></blockquote>
</li>
<li><p class="first"><a class="reference internal" href="../configuration.html#std:setting-CELERY_ROUTES"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_ROUTES</span></code></a> was broken if set to a single dict.</p>
<blockquote>
<div><p>This example in the docs should now work again:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">CELERY_ROUTES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;feed.tasks.import_feed&quot;</span><span class="p">:</span> <span class="s2">&quot;feeds&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first"><cite>CREATE_MISSING_QUEUES</cite> was not honored by apply_async.</p>
</li>
<li><p class="first">New remote control command: <cite>stats</cite></p>
<blockquote>
<div><p>Dumps information about the worker, like pool process ids, and
total number of tasks executed by type.</p>
<p>Example reply:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s1">&#39;worker.local&#39;</span><span class="p">:</span>
     <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;tasks.sleeptask&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span>
     <span class="s1">&#39;pool&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;timeouts&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
              <span class="s1">&#39;processes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">60376</span><span class="p">,</span> <span class="mi">60377</span><span class="p">],</span>
              <span class="s1">&#39;max-concurrency&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
              <span class="s1">&#39;max-tasks-per-child&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
              <span class="s1">&#39;put-guarded-by-semaphore&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}]</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">New remote control command: <cite>dump_active</cite></p>
<blockquote>
<div><p>Gives a list of tasks currently being executed by the worker.
By default arguments are passed through repr in case there
are arguments that is not JSON encodable. If you know
the arguments are JSON safe, you can pass the argument <cite>safe=True</cite>.</p>
<p>Example reply:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">broadcast</span><span class="p">(</span><span class="s2">&quot;dump_active&quot;</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;safe&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span> <span class="n">reply</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[{&#39;worker.local&#39;: [</span>
<span class="go">    {&#39;args&#39;: &#39;(1,)&#39;,</span>
<span class="go">     &#39;time_start&#39;: 1278580542.6300001,</span>
<span class="go">     &#39;name&#39;: &#39;tasks.sleeptask&#39;,</span>
<span class="go">     &#39;delivery_info&#39;: {</span>
<span class="go">         &#39;consumer_tag&#39;: &#39;30&#39;,</span>
<span class="go">         &#39;routing_key&#39;: &#39;celery&#39;,</span>
<span class="go">         &#39;exchange&#39;: &#39;celery&#39;},</span>
<span class="go">     &#39;hostname&#39;: &#39;casper.local&#39;,</span>
<span class="go">     &#39;acknowledged&#39;: True,</span>
<span class="go">     &#39;kwargs&#39;: &#39;{}&#39;,</span>
<span class="go">     &#39;id&#39;: &#39;802e93e9-e470-47ed-b913-06de8510aca2&#39;,</span>
<span class="go">    }</span>
<span class="go">]}]</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Added experimental support for persistent revokes.</p>
<blockquote>
<div><p>Use the <cite>-S|&#8211;statedb</cite> argument to the worker to enable it:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ celeryd --statedb<span class="o">=</span>/var/run/celeryd
</pre></div>
</div>
<p>This will use the file: <cite>/var/run/celeryd.db</cite>,
as the <cite>shelve</cite> module automatically adds the <cite>.db</cite> suffix.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="version-2-0-0">
<span id="id4"></span><h2><a class="toc-backref" href="#id10">2.0.0</a><a class="headerlink" href="#version-2-0-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-07-02 02:30 P.M CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<div class="section" id="foreword">
<h3><a class="toc-backref" href="#id11">Foreword</a><a class="headerlink" href="#foreword" title="Permalink to this headline">¶</a></h3>
<p>Celery 2.0 contains backward incompatible changes, the most important
being that the Django dependency has been removed so Celery no longer
supports Django out of the box, but instead as an add-on package
called <a class="reference external" href="http://pypi.python.org/pypi/django-celery">django-celery</a>.</p>
<p>We&#8217;re very sorry for breaking backwards compatibility, but there&#8217;s
also many new and exciting features to make up for the time you lose
upgrading, so be sure to read the <a class="reference internal" href="#v200-news"><span class="std std-ref">News</span></a> section.</p>
<p>Quite a lot of potential users have been upset about the Django dependency,
so maybe this is a chance to get wider adoption by the Python community as
well.</p>
<p>Big thanks to all contributors, testers and users!</p>
</div>
<div class="section" id="upgrading-for-django-users">
<span id="v200-django-upgrade"></span><h3><a class="toc-backref" href="#id12">Upgrading for Django-users</a><a class="headerlink" href="#upgrading-for-django-users" title="Permalink to this headline">¶</a></h3>
<p>Django integration has been moved to a separate package: <a class="reference external" href="http://pypi.python.org/pypi/django-celery">django-celery</a>.</p>
<ul>
<li><p class="first">To upgrade you need to install the <a class="reference external" href="http://pypi.python.org/pypi/django-celery">django-celery</a> module and change:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="s2">&quot;celery&quot;</span>
</pre></div>
</div>
<p>to:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="s2">&quot;djcelery&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first">If you use <cite>mod_wsgi</cite> you need to add the following line to your <cite>.wsgi</cite>
file:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CELERY_LOADER&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;django&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first">The following modules has been moved to <a class="reference external" href="http://pypi.python.org/pypi/django-celery">django-celery</a>:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Module name</strong></th>
<th class="head"><strong>Replace with</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><cite>celery.models</cite></td>
<td><cite>djcelery.models</cite></td>
</tr>
<tr class="row-odd"><td><cite>celery.managers</cite></td>
<td><cite>djcelery.managers</cite></td>
</tr>
<tr class="row-even"><td><cite>celery.views</cite></td>
<td><cite>djcelery.views</cite></td>
</tr>
<tr class="row-odd"><td><cite>celery.urls</cite></td>
<td><cite>djcelery.urls</cite></td>
</tr>
<tr class="row-even"><td><cite>celery.management</cite></td>
<td><cite>djcelery.management</cite></td>
</tr>
<tr class="row-odd"><td><cite>celery.loaders.djangoapp</cite></td>
<td><cite>djcelery.loaders</cite></td>
</tr>
<tr class="row-even"><td><cite>celery.backends.database</cite></td>
<td><cite>djcelery.backends.database</cite></td>
</tr>
<tr class="row-odd"><td><cite>celery.backends.cache</cite></td>
<td><cite>djcelery.backends.cache</cite></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
</ul>
<p>Importing <code class="xref py py-mod docutils literal"><span class="pre">djcelery</span></code> will automatically setup Celery to use Django loader.
loader.  It does this by setting the <span class="target" id="index-0"></span><code class="xref std std-envvar docutils literal"><span class="pre">CELERY_LOADER</span></code> environment variable to
<cite>&#8220;django&#8221;</cite> (it won&#8217;t change it if a loader is already set.)</p>
<p>When the Django loader is used, the &#8220;database&#8221; and &#8220;cache&#8221; result backend
aliases will point to the <code class="xref py py-mod docutils literal"><span class="pre">djcelery</span></code> backends instead of the built-in backends,
and configuration will be read from the Django settings.</p>
</div>
<div class="section" id="upgrading-for-others">
<span id="v200-upgrade"></span><h3><a class="toc-backref" href="#id13">Upgrading for others</a><a class="headerlink" href="#upgrading-for-others" title="Permalink to this headline">¶</a></h3>
<div class="section" id="database-result-backend">
<span id="v200-upgrade-database"></span><h4><a class="toc-backref" href="#id14">Database result backend</a><a class="headerlink" href="#database-result-backend" title="Permalink to this headline">¶</a></h4>
<p>The database result backend is now using <a class="reference external" href="http://www.sqlalchemy.org">SQLAlchemy</a> instead of the
Django ORM, see <a class="reference external" href="http://www.sqlalchemy.org/docs/core/engines.html#supported-databases">Supported Databases</a> for a table of supported databases.</p>
<p>The <cite>DATABASE_*</cite> settings has been replaced by a single setting:
<a class="reference internal" href="../configuration.html#std:setting-CELERY_RESULT_DBURI"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_RESULT_DBURI</span></code></a>. The value here should be an
<a class="reference external" href="http://www.sqlalchemy.org/docs/core/engines.html#database-urls">SQLAlchemy Connection String</a>, some examples include:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># sqlite (filename)</span>
<span class="n">CELERY_RESULT_DBURI</span> <span class="o">=</span> <span class="s2">&quot;sqlite:///celerydb.sqlite&quot;</span>

<span class="c1"># mysql</span>
<span class="n">CELERY_RESULT_DBURI</span> <span class="o">=</span> <span class="s2">&quot;mysql://scott:tiger@localhost/foo&quot;</span>

<span class="c1"># postgresql</span>
<span class="n">CELERY_RESULT_DBURI</span> <span class="o">=</span> <span class="s2">&quot;postgresql://scott:tiger@localhost/mydatabase&quot;</span>

<span class="c1"># oracle</span>
<span class="n">CELERY_RESULT_DBURI</span> <span class="o">=</span> <span class="s2">&quot;oracle://scott:tiger@127.0.0.1:1521/sidname&quot;</span>
</pre></div>
</div>
<p>See <a class="reference external" href="http://www.sqlalchemy.org/docs/core/engines.html#database-urls">SQLAlchemy Connection Strings</a> for more information about connection
strings.</p>
<p>To specify additional SQLAlchemy database engine options you can use
the <a class="reference internal" href="../configuration.html#std:setting-CELERY_RESULT_ENGINE_OPTIONS"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_RESULT_ENGINE_OPTIONS</span></code></a> setting:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="c1"># echo enables verbose logging from SQLAlchemy.</span>
<span class="n">CELERY_RESULT_ENGINE_OPTIONS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;echo&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="cache-result-backend">
<span id="v200-upgrade-cache"></span><h4><a class="toc-backref" href="#id15">Cache result backend</a><a class="headerlink" href="#cache-result-backend" title="Permalink to this headline">¶</a></h4>
<p>The cache result backend is no longer using the Django cache framework,
but it supports mostly the same configuration syntax:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">CELERY_CACHE_BACKEND</span> <span class="o">=</span> <span class="s2">&quot;memcached://A.example.com:11211;B.example.com&quot;</span>
</pre></div>
</div>
<p>To use the cache backend you must either have the <a class="reference external" href="http://pypi.python.org/pypi/pylibmc">pylibmc</a> or
<a class="reference external" href="http://pypi.python.org/pypi/python-memcached">python-memcached</a> library installed, of which the former is regarded
as the best choice.</p>
<p>The support backend types are <cite>memcached://</cite> and <cite>memory://</cite>,
we haven&#8217;t felt the need to support any of the other backends
provided by Django.</p>
</div>
</div>
<div class="section" id="backward-incompatible-changes">
<span id="v200-incompatible"></span><h3><a class="toc-backref" href="#id16">Backward incompatible changes</a><a class="headerlink" href="#backward-incompatible-changes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Default (python) loader now prints warning on missing <cite>celeryconfig.py</cite>
instead of raising <a class="reference external" href="https://docs.python.org/dev/library/exceptions.html#ImportError" title="(in Python v3.11)"><code class="xref py py-exc docutils literal"><span class="pre">ImportError</span></code></a>.</p>
<blockquote>
<div><p>The worker raises <a class="reference internal" href="../reference/celery.exceptions.html#celery.exceptions.ImproperlyConfigured" title="celery.exceptions.ImproperlyConfigured"><code class="xref py py-exc docutils literal"><span class="pre">ImproperlyConfigured</span></code></a> if the configuration
is not set up. This makes it possible to use <cite>&#8211;help</cite> etc., without having a
working configuration.</p>
<p>Also this makes it possible to use the client side of celery without being
configured:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">carrot.connection</span> <span class="kn">import</span> <span class="n">BrokerConnection</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span> <span class="o">=</span> <span class="n">BrokerConnection</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="s2">&quot;guest&quot;</span><span class="p">,</span> <span class="s2">&quot;guest&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">celery.execute</span> <span class="kn">import</span> <span class="n">send_task</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">send_task</span><span class="p">(</span><span class="s2">&quot;celery.ping&quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">connection</span><span class="o">=</span><span class="n">conn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">celery.backends.amqp</span> <span class="kn">import</span> <span class="n">AMQPBackend</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">backend</span> <span class="o">=</span> <span class="n">AMQPBackend</span><span class="p">(</span><span class="n">connection</span><span class="o">=</span><span class="n">conn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">&#39;pong&#39;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">The following deprecated settings has been removed (as scheduled by
the <a class="reference internal" href="../internals/deprecation.html#deprecation-timeline"><span class="std std-ref">Celery Deprecation Timeline</span></a>):</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Setting name</strong></th>
<th class="head"><strong>Replace with</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><cite>CELERY_AMQP_CONSUMER_QUEUES</cite></td>
<td><cite>CELERY_QUEUES</cite></td>
</tr>
<tr class="row-odd"><td><cite>CELERY_AMQP_EXCHANGE</cite></td>
<td><cite>CELERY_DEFAULT_EXCHANGE</cite></td>
</tr>
<tr class="row-even"><td><cite>CELERY_AMQP_EXCHANGE_TYPE</cite></td>
<td><cite>CELERY_DEFAULT_EXCHANGE_TYPE</cite></td>
</tr>
<tr class="row-odd"><td><cite>CELERY_AMQP_CONSUMER_ROUTING_KEY</cite></td>
<td><cite>CELERY_QUEUES</cite></td>
</tr>
<tr class="row-even"><td><cite>CELERY_AMQP_PUBLISHER_ROUTING_KEY</cite></td>
<td><cite>CELERY_DEFAULT_ROUTING_KEY</cite></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
<li><p class="first">The <cite>celery.task.rest</cite> module has been removed, use <a class="reference internal" href="../userguide/remote-tasks.html#module-celery.task.http" title="celery.task.http"><code class="xref py py-mod docutils literal"><span class="pre">celery.task.http</span></code></a>
instead (as scheduled by the <a class="reference internal" href="../internals/deprecation.html#deprecation-timeline"><span class="std std-ref">Celery Deprecation Timeline</span></a>).</p>
</li>
<li><p class="first">It&#8217;s no longer allowed to skip the class name in loader names.
(as scheduled by the <a class="reference internal" href="../internals/deprecation.html#deprecation-timeline"><span class="std std-ref">Celery Deprecation Timeline</span></a>):</p>
<blockquote>
<div><p>Assuming the implicit <cite>Loader</cite> class name is no longer supported,
if you use e.g.:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">CELERY_LOADER</span> <span class="o">=</span> <span class="s2">&quot;myapp.loaders&quot;</span>
</pre></div>
</div>
<p>You need to include the loader class name, like this:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">CELERY_LOADER</span> <span class="o">=</span> <span class="s2">&quot;myapp.loaders.Loader&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first"><a class="reference internal" href="../configuration.html#std:setting-CELERY_TASK_RESULT_EXPIRES"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_TASK_RESULT_EXPIRES</span></code></a> now defaults to 1 day.</p>
<blockquote>
<div><p>Previous default setting was to expire in 5 days.</p>
</div></blockquote>
</li>
<li><p class="first">AMQP backend: Don&#8217;t use different values for <cite>auto_delete</cite>.</p>
<blockquote>
<div><p>This bug became visible with RabbitMQ 1.8.0, which no longer
allows conflicting declarations for the auto_delete and durable settings.</p>
<p>If you&#8217;ve already used celery with this backend chances are you
have to delete the previous declaration:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ camqadm exchange.delete celeryresults
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Now uses pickle instead of cPickle on Python versions &lt;= 2.5</p>
<blockquote>
<div><p>cPickle is broken in Python &lt;= 2.5.</p>
<p>It unsafely and incorrectly uses relative instead of absolute imports,
so e.g.:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">exceptions</span><span class="o">.</span><span class="n">KeyError</span>
</pre></div>
</div>
<p>becomes:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">celery</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">KeyError</span>
</pre></div>
</div>
<p>Your best choice is to upgrade to Python 2.6,
as while the pure pickle version has worse performance,
it is the only safe option for older Python versions.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="news">
<span id="v200-news"></span><h3><a class="toc-backref" href="#id17">News</a><a class="headerlink" href="#news" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><strong>celeryev</strong>: Curses Celery Monitor and Event Viewer.</p>
<blockquote>
<div><p>This is a simple monitor allowing you to see what tasks are
executing in real-time and investigate tracebacks and results of ready
tasks. It also enables you to set new rate limits and revoke tasks.</p>
<p>Screenshot:</p>
<div class="figure">
<img alt="../_images/celeryevshotsm.jpg" src="../_images/celeryevshotsm.jpg" />
</div>
<p>If you run <cite>celeryev</cite> with the <cite>-d</cite> switch it will act as an event
dumper, simply dumping the events it receives to standard out:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ celeryev -d
-&gt; celeryev: starting capture...
casper.local <span class="o">[</span><span class="m">2010</span>-06-04 <span class="m">10</span>:42:07.020000<span class="o">]</span> heartbeat
casper.local <span class="o">[</span><span class="m">2010</span>-06-04 <span class="m">10</span>:42:14.750000<span class="o">]</span> task received:
    tasks.add<span class="o">(</span>61a68756-27f4-4879-b816-3cf815672b0e<span class="o">)</span> <span class="nv">args</span><span class="o">=[</span><span class="m">2</span>, <span class="m">2</span><span class="o">]</span> <span class="nv">kwargs</span><span class="o">={}</span>
    <span class="nv">eta</span><span class="o">=</span><span class="m">2010</span>-06-04T10:42:16.669290, <span class="nv">retries</span><span class="o">=</span><span class="m">0</span>
casper.local <span class="o">[</span><span class="m">2010</span>-06-04 <span class="m">10</span>:42:17.230000<span class="o">]</span> task started
    tasks.add<span class="o">(</span>61a68756-27f4-4879-b816-3cf815672b0e<span class="o">)</span> <span class="nv">args</span><span class="o">=[</span><span class="m">2</span>, <span class="m">2</span><span class="o">]</span> <span class="nv">kwargs</span><span class="o">={}</span>
casper.local <span class="o">[</span><span class="m">2010</span>-06-04 <span class="m">10</span>:42:17.960000<span class="o">]</span> task succeeded:
    tasks.add<span class="o">(</span>61a68756-27f4-4879-b816-3cf815672b0e<span class="o">)</span>
    <span class="nv">args</span><span class="o">=[</span><span class="m">2</span>, <span class="m">2</span><span class="o">]</span> <span class="nv">kwargs</span><span class="o">={}</span> <span class="nv">result</span><span class="o">=</span><span class="m">4</span>, <span class="nv">runtime</span><span class="o">=</span><span class="m">0</span>.782663106918

The fields here are, <span class="k">in</span> order: *sender hostname*, *timestamp*, *event type* and
*additional event fields*.
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">AMQP result backend: Now supports <cite>.ready()</cite>, <cite>.successful()</cite>,
<cite>.result</cite>, <cite>.status</cite>, and even responds to changes in task state</p>
</li>
<li><p class="first">New user guides:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="../userguide/workers.html#guide-workers"><span class="std std-ref">Workers Guide</span></a></li>
<li><a class="reference internal" href="../userguide/canvas.html#guide-canvas"><span class="std std-ref">Canvas: Designing Workflows</span></a></li>
<li><a class="reference internal" href="../userguide/routing.html#guide-routing"><span class="std std-ref">Routing Tasks</span></a></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Worker: Standard out/error is now being redirected to the log file.</p>
</li>
<li><p class="first"><code class="xref py py-mod docutils literal"><span class="pre">billiard</span></code> has been moved back to the celery repository.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Module name</strong></th>
<th class="head"><strong>celery equivalent</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><cite>billiard.pool</cite></td>
<td><cite>celery.concurrency.processes.pool</cite></td>
</tr>
<tr class="row-odd"><td><cite>billiard.serialization</cite></td>
<td><cite>celery.serialization</cite></td>
</tr>
<tr class="row-even"><td><cite>billiard.utils.functional</cite></td>
<td><cite>celery.utils.functional</cite></td>
</tr>
</tbody>
</table>
<p>The <code class="xref py py-mod docutils literal"><span class="pre">billiard</span></code> distribution may be maintained, depending on interest.</p>
</div></blockquote>
</li>
<li><p class="first">now depends on <code class="xref py py-mod docutils literal"><span class="pre">carrot</span></code> &gt;= 0.10.5</p>
</li>
<li><p class="first">now depends on <code class="xref py py-mod docutils literal"><span class="pre">pyparsing</span></code></p>
</li>
<li><p class="first">Worker: Added <cite>&#8211;purge</cite> as an alias to <cite>&#8211;discard</cite>.</p>
</li>
<li><p class="first">Worker: Ctrl+C (SIGINT) once does warm shutdown, hitting Ctrl+C twice
forces termination.</p>
</li>
<li><p class="first">Added support for using complex crontab-expressions in periodic tasks. For
example, you can now use:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">crontab</span><span class="p">(</span><span class="n">minute</span><span class="o">=</span><span class="s2">&quot;*/15&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>or even:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">crontab</span><span class="p">(</span><span class="n">minute</span><span class="o">=</span><span class="s2">&quot;*/30&quot;</span><span class="p">,</span> <span class="n">hour</span><span class="o">=</span><span class="s2">&quot;8-17,1-2&quot;</span><span class="p">,</span> <span class="n">day_of_week</span><span class="o">=</span><span class="s2">&quot;thu-fri&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../userguide/periodic-tasks.html#guide-beat"><span class="std std-ref">Periodic Tasks</span></a>.</p>
</li>
<li><p class="first">Worker: Now waits for available pool processes before applying new
tasks to the pool.</p>
<blockquote>
<div><p>This means it doesn&#8217;t have to wait for dozens of tasks to finish at shutdown
because it has applied prefetched tasks without having any pool
processes available to immediately accept them.</p>
<p>See <a class="reference external" href="https://github.com/celery/celery/issues/122"><span class="xref issue">issue #122</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">New built-in way to do task callbacks using
<code class="xref py py-class docutils literal"><span class="pre">subtask</span></code>.</p>
<p>See <a class="reference internal" href="../userguide/canvas.html#guide-canvas"><span class="std std-ref">Canvas: Designing Workflows</span></a> for more information.</p>
</li>
<li><p class="first">TaskSets can now contain several types of tasks.</p>
<p><code class="xref py py-class docutils literal"><span class="pre">TaskSet</span></code> has been refactored to use
a new syntax, please see <a class="reference internal" href="../userguide/canvas.html#guide-canvas"><span class="std std-ref">Canvas: Designing Workflows</span></a> for more information.</p>
<p>The previous syntax is still supported, but will be deprecated in
version 1.4.</p>
</li>
<li><p class="first">TaskSet failed() result was incorrect.</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/132"><span class="xref issue">issue #132</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">Now creates different loggers per task class.</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/129"><span class="xref issue">issue #129</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">Missing queue definitions are now created automatically.</p>
<blockquote>
<div><blockquote>
<div><p>You can disable this using the <a class="reference internal" href="../configuration.html#std:setting-CELERY_CREATE_MISSING_QUEUES"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_CREATE_MISSING_QUEUES</span></code></a>
setting.</p>
<p>The missing queues are created with the following options:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">CELERY_QUEUES</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;exchange&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                       <span class="s2">&quot;exchange_type&quot;</span><span class="p">:</span> <span class="s2">&quot;direct&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;routing_key&quot;</span><span class="p">:</span> <span class="s2">&quot;name}</span>
</pre></div>
</div>
</div></blockquote>
<p>This feature is added for easily setting up routing using the <cite>-Q</cite>
option to the worker:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ celeryd -Q video, image
</pre></div>
</div>
<p>See the new routing section of the User Guide for more information:
<a class="reference internal" href="../userguide/routing.html#guide-routing"><span class="std std-ref">Routing Tasks</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">New Task option: <cite>Task.queue</cite></p>
<blockquote>
<div><p>If set, message options will be taken from the corresponding entry
in <a class="reference internal" href="../configuration.html#std:setting-CELERY_QUEUES"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_QUEUES</span></code></a>. <cite>exchange</cite>, <cite>exchange_type</cite> and <cite>routing_key</cite>
will be ignored</p>
</div></blockquote>
</li>
<li><p class="first">Added support for task soft and hard time limits.</p>
<blockquote>
<div><p>New settings added:</p>
<ul>
<li><p class="first"><a class="reference internal" href="../configuration.html#std:setting-CELERYD_TASK_TIME_LIMIT"><code class="xref std std-setting docutils literal"><span class="pre">CELERYD_TASK_TIME_LIMIT</span></code></a></p>
<blockquote>
<div><p>Hard time limit. The worker processing the task will be killed and
replaced with a new one when this is exceeded.</p>
</div></blockquote>
</li>
<li><p class="first"><a class="reference internal" href="../configuration.html#std:setting-CELERYD_TASK_SOFT_TIME_LIMIT"><code class="xref std std-setting docutils literal"><span class="pre">CELERYD_TASK_SOFT_TIME_LIMIT</span></code></a></p>
<blockquote>
<div><p>Soft time limit. The <a class="reference internal" href="../reference/celery.exceptions.html#celery.exceptions.SoftTimeLimitExceeded" title="celery.exceptions.SoftTimeLimitExceeded"><code class="xref py py-exc docutils literal"><span class="pre">SoftTimeLimitExceeded</span></code></a>
exception will be raised when this is exceeded.  The task can catch
this to e.g. clean up before the hard time limit comes.</p>
</div></blockquote>
</li>
</ul>
<p>New command-line arguments to celeryd added:
<cite>&#8211;time-limit</cite> and <cite>&#8211;soft-time-limit</cite>.</p>
<p>What&#8217;s left?</p>
<p>This won&#8217;t work on platforms not supporting signals (and specifically
the <cite>SIGUSR1</cite> signal) yet. So an alternative the ability to disable
the feature all together on nonconforming platforms must be implemented.</p>
<p>Also when the hard time limit is exceeded, the task result should
be a <cite>TimeLimitExceeded</cite> exception.</p>
</div></blockquote>
</li>
<li><p class="first">Test suite is now passing without a running broker, using the carrot
in-memory backend.</p>
</li>
<li><p class="first">Log output is now available in colors.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Log level</strong></th>
<th class="head"><strong>Color</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><cite>DEBUG</cite></td>
<td>Blue</td>
</tr>
<tr class="row-odd"><td><cite>WARNING</cite></td>
<td>Yellow</td>
</tr>
<tr class="row-even"><td><cite>CRITICAL</cite></td>
<td>Magenta</td>
</tr>
<tr class="row-odd"><td><cite>ERROR</cite></td>
<td>Red</td>
</tr>
</tbody>
</table>
<p>This is only enabled when the log output is a tty.
You can explicitly enable/disable this feature using the
<a class="reference internal" href="../configuration.html#std:setting-CELERYD_LOG_COLOR"><code class="xref std std-setting docutils literal"><span class="pre">CELERYD_LOG_COLOR</span></code></a> setting.</p>
</div></blockquote>
</li>
<li><p class="first">Added support for task router classes (like the django multi-db routers)</p>
<blockquote>
<div><ul class="simple">
<li>New setting: <a class="reference internal" href="../configuration.html#std:setting-CELERY_ROUTES"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_ROUTES</span></code></a></li>
</ul>
<p>This is a single, or a list of routers to traverse when
sending tasks. Dictionaries in this list converts to a
<code class="xref py py-class docutils literal"><span class="pre">celery.routes.MapRoute</span></code> instance.</p>
<p>Examples:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CELERY_ROUTES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;celery.ping&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
<span class="go">                     &quot;mytasks.add&quot;: &quot;cpu-bound&quot;,</span>
<span class="go">                     &quot;video.encode&quot;: {</span>
<span class="go">                         &quot;queue&quot;: &quot;video&quot;,</span>
<span class="go">                         &quot;exchange&quot;: &quot;media&quot;</span>
<span class="go">                         &quot;routing_key&quot;: &quot;media.video.encode&quot;}}</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CELERY_ROUTES</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;myapp.tasks.Router&quot;</span><span class="p">,</span>
<span class="go">                     {&quot;celery.ping&quot;: &quot;default})</span>
</pre></div>
</div>
<p>Where <cite>myapp.tasks.Router</cite> could be:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Router</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">route_for_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">task</span> <span class="o">==</span> <span class="s2">&quot;celery.ping&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;default&quot;</span>
</pre></div>
</div>
<p>route_for_task may return a string or a dict. A string then means
it&#8217;s a queue name in <a class="reference internal" href="../configuration.html#std:setting-CELERY_QUEUES"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_QUEUES</span></code></a>, a dict means it&#8217;s a custom route.</p>
<p>When sending tasks, the routers are consulted in order. The first
router that doesn&#8217;t return <cite>None</cite> is the route to use. The message options
is then merged with the found route settings, where the routers settings
have priority.</p>
<p>Example if <code class="xref py py-func docutils literal"><span class="pre">apply_async()</span></code> has these arguments:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Task</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">immediate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;video&quot;</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">routing_key</span><span class="o">=</span><span class="s2">&quot;video.compress&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>and a router returns:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;immediate&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
 <span class="s2">&quot;exchange&quot;</span><span class="p">:</span> <span class="s2">&quot;urgent&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>the final message options will be:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">immediate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;urgent&quot;</span><span class="p">,</span> <span class="n">routing_key</span><span class="o">=</span><span class="s2">&quot;video.compress&quot;</span>
</pre></div>
</div>
<p>(and any default message options defined in the
<code class="xref py py-class docutils literal"><span class="pre">Task</span></code> class)</p>
</div></blockquote>
</li>
<li><p class="first">New Task handler called after the task returns:
<code class="xref py py-meth docutils literal"><span class="pre">after_return()</span></code>.</p>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="../internals/reference/celery.datastructures.html#celery.datastructures.ExceptionInfo" title="celery.datastructures.ExceptionInfo"><code class="xref py py-class docutils literal"><span class="pre">ExceptionInfo</span></code></a> now passed to</dt>
<dd><p class="first last"><code class="xref py py-meth docutils literal"><span class="pre">on_retry()</span></code>/
<code class="xref py py-meth docutils literal"><span class="pre">on_failure()</span></code> as einfo keyword argument.</p>
</dd>
</dl>
</li>
<li><p class="first">Worker: Added <a class="reference internal" href="../configuration.html#std:setting-CELERYD_MAX_TASKS_PER_CHILD"><code class="xref std std-setting docutils literal"><span class="pre">CELERYD_MAX_TASKS_PER_CHILD</span></code></a> /
<code class="xref std std-option docutils literal"><span class="pre">--maxtasksperchild</span></code></p>
<blockquote>
<div><p>Defines the maximum number of tasks a pool worker can process before
the process is terminated and replaced by a new one.</p>
</div></blockquote>
</li>
<li><p class="first">Revoked tasks now marked with state <a class="reference internal" href="../userguide/tasks.html#std:state-REVOKED"><code class="xref std std-state docutils literal"><span class="pre">REVOKED</span></code></a>, and <cite>result.get()</cite>
will now raise <a class="reference internal" href="../reference/celery.exceptions.html#celery.exceptions.TaskRevokedError" title="celery.exceptions.TaskRevokedError"><code class="xref py py-exc docutils literal"><span class="pre">TaskRevokedError</span></code></a>.</p>
</li>
<li><p class="first"><code class="xref py py-func docutils literal"><span class="pre">celery.task.control.ping()</span></code> now works as expected.</p>
</li>
<li><p class="first"><cite>apply(throw=True)</cite> / <a class="reference internal" href="../configuration.html#std:setting-CELERY_EAGER_PROPAGATES_EXCEPTIONS"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_EAGER_PROPAGATES_EXCEPTIONS</span></code></a>:
Makes eager execution re-raise task errors.</p>
</li>
<li><p class="first">New signal: <code class="xref std std-signal docutils literal"><span class="pre">~celery.signals.worker_process_init</span></code>: Sent inside the
pool worker process at init.</p>
</li>
<li><p class="first">Worker: <code class="xref std std-option docutils literal"><span class="pre">-Q</span></code> option: Ability to specify list of queues to use,
disabling other configured queues.</p>
<blockquote>
<div><p>For example, if <a class="reference internal" href="../configuration.html#std:setting-CELERY_QUEUES"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_QUEUES</span></code></a> defines four
queues: <cite>image</cite>, <cite>video</cite>, <cite>data</cite> and <cite>default</cite>, the following
command would make the worker only consume from the <cite>image</cite> and <cite>video</cite>
queues:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ celeryd -Q image,video
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Worker: New return value for the <cite>revoke</cite> control command:</p>
<blockquote>
<div><p>Now returns:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;ok&quot;</span><span class="p">:</span> <span class="s2">&quot;task $id revoked&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>instead of <cite>True</cite>.</p>
</div></blockquote>
</li>
<li><p class="first">Worker: Can now enable/disable events using remote control</p>
<blockquote>
<div><p>Example usage:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">celery.task.control</span> <span class="kn">import</span> <span class="n">broadcast</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">broadcast</span><span class="p">(</span><span class="s2">&quot;enable_events&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">broadcast</span><span class="p">(</span><span class="s2">&quot;disable_events&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Removed top-level tests directory. Test config now in celery.tests.config</p>
<blockquote>
<div><p>This means running the unit tests doesn&#8217;t require any special setup.
<cite>celery/tests/__init__</cite> now configures the <span class="target" id="index-1"></span><code class="xref std std-envvar docutils literal"><span class="pre">CELERY_CONFIG_MODULE</span></code>
and <span class="target" id="index-2"></span><code class="xref std std-envvar docutils literal"><span class="pre">CELERY_LOADER</span></code> environment variables, so when <cite>nosetests</cite>
imports that, the unit test environment is all set up.</p>
<p>Before you run the tests you need to install the test requirements:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ pip install -r requirements/test.txt
</pre></div>
</div>
<p>Running all tests:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ nosetests
</pre></div>
</div>
<p>Specifying the tests to run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ nosetests celery.tests.test_task
</pre></div>
</div>
<p>Producing HTML coverage:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ nosetests --with-coverage3
</pre></div>
</div>
<p>The coverage output is then located in <cite>celery/tests/cover/index.html</cite>.</p>
</div></blockquote>
</li>
<li><p class="first">Worker: New option <cite>&#8211;version</cite>: Dump version info and exit.</p>
</li>
<li><p class="first"><code class="xref py py-mod docutils literal"><span class="pre">celeryd-multi</span></code>: Tool for shell scripts
to start multiple workers.</p>
<blockquote>
<div><p>Some examples:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># Advanced example with 10 workers:</span>
<span class="c1">#   * Three of the workers processes the images and video queue</span>
<span class="c1">#   * Two of the workers processes the data queue with loglevel DEBUG</span>
<span class="c1">#   * the rest processes the default&#39; queue.</span>
$ celeryd-multi start <span class="m">10</span> -l INFO -Q:1-3 images,video -Q:4,5:data
    -Q default -L:4,5 DEBUG

<span class="c1"># get commands to start 10 workers, with 3 processes each</span>
$ celeryd-multi start <span class="m">3</span> -c <span class="m">3</span>
celeryd -n celeryd1.myhost -c <span class="m">3</span>
celeryd -n celeryd2.myhost -c <span class="m">3</span>
celeryd -n celeryd3.myhost -c <span class="m">3</span>

<span class="c1"># start 3 named workers</span>
$ celeryd-multi start image video data -c <span class="m">3</span>
celeryd -n image.myhost -c <span class="m">3</span>
celeryd -n video.myhost -c <span class="m">3</span>
celeryd -n data.myhost -c <span class="m">3</span>

<span class="c1"># specify custom hostname</span>
$ celeryd-multi start <span class="m">2</span> -n worker.example.com -c <span class="m">3</span>
celeryd -n celeryd1.worker.example.com -c <span class="m">3</span>
celeryd -n celeryd2.worker.example.com -c <span class="m">3</span>

<span class="c1"># Additionl options are added to each celeryd&#39;,</span>
<span class="c1"># but you can also modify the options for ranges of or single workers</span>

<span class="c1"># 3 workers: Two with 3 processes, and one with 10 processes.</span>
$ celeryd-multi start <span class="m">3</span> -c <span class="m">3</span> -c:1 <span class="m">10</span>
celeryd -n celeryd1.myhost -c <span class="m">10</span>
celeryd -n celeryd2.myhost -c <span class="m">3</span>
celeryd -n celeryd3.myhost -c <span class="m">3</span>

<span class="c1"># can also specify options for named workers</span>
$ celeryd-multi start image video data -c <span class="m">3</span> -c:image <span class="m">10</span>
celeryd -n image.myhost -c <span class="m">10</span>
celeryd -n video.myhost -c <span class="m">3</span>
celeryd -n data.myhost -c <span class="m">3</span>

<span class="c1"># ranges and lists of workers in options is also allowed:</span>
<span class="c1"># (-c:1-3 can also be written as -c:1,2,3)</span>
$ celeryd-multi start <span class="m">5</span> -c <span class="m">3</span>  -c:1-3 <span class="m">10</span>
celeryd-multi -n celeryd1.myhost -c <span class="m">10</span>
celeryd-multi -n celeryd2.myhost -c <span class="m">10</span>
celeryd-multi -n celeryd3.myhost -c <span class="m">10</span>
celeryd-multi -n celeryd4.myhost -c <span class="m">3</span>
celeryd-multi -n celeryd5.myhost -c <span class="m">3</span>

<span class="c1"># lists also works with named workers</span>
$ celeryd-multi start foo bar baz xuzzy -c <span class="m">3</span> -c:foo,bar,baz <span class="m">10</span>
celeryd-multi -n foo.myhost -c <span class="m">10</span>
celeryd-multi -n bar.myhost -c <span class="m">10</span>
celeryd-multi -n baz.myhost -c <span class="m">10</span>
celeryd-multi -n xuzzy.myhost -c <span class="m">3</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">The worker now calls the result backends <cite>process_cleanup</cite> method
<em>after</em> task execution instead of before.</p>
</li>
<li><p class="first">AMQP result backend now supports Pika.</p>
</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="logo"><a href="../index.html">
  <img class="logo" src="http://cloud.github.com/downloads/celery/celery/celery_128.png" alt="Logo"/>
</a></p>
<div id="donate">
    <b>Donations welcome:</b>
    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
    <input type="hidden" name="cmd" value="_s-xclick">
    <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----MIIHTwYJKoZIhvcNAQcEoIIHQDCCBzwCAQExggEwMIIBLAIBADCBlDCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20CAQAwDQYJKoZIhvcNAQEBBQAEgYA2+c723xlntHKQYQR9yn9BEtUhDoUUlnOqhniqvNMWB4k2R0JpVkrNSu5JCbdjNOqDXKHoRfIWe3HXJJMPZBJKFMD5Izprb6xEZlTGaWnlrGXFfkdBaILQQgWYqV0DnuNmtDXCvfYmyu0p1K04wLjAJ1ufnBSP1UaS6BTcoIOOuTELMAkGBSsOAwIaBQAwgcwGCSqGSIb3DQEHATAUBggqhkiG9w0DBwQIFg/2qPwa7UCAgah20QLIllcp0VHazYo2C9h8c6gn8MTcTnpW0WFXhz9ylc/i5dCXabkrrLBBfg8NygAuvYRr4k1zdC0AJIgsV/6rSAhehabRvjRDH2EZ8OieqHfIPfkAcTm+JqbS6Z27lXkebYPnJzhkZxW7+ZC6hU/H40JFXChTag8lhqJfZELiOZLWxxilj2mkwlkdMx1YL6lcPAA7ajpAwjsnJYd/9VxLA6MDmcOu+TKgggOHMIIDgzCCAuygAwIBAgIBADANBgkqhkiG9w0BAQUFADCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20wHhcNMDQwMjEzMTAxMzE1WhcNMzUwMjEzMTAxMzE1WjCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMFHTt38RMxLXJyO2SmS+Ndl72T7oKJ4u4uw+6awntALWh03PewmIJuzbALScsTS4sZoS1fKciBGoh11gIfHzylvkdNe/hJl66/RGqrj5rFb08sAABNTzDTiqqNpJeBsYs/c2aiGozptX2RlnBktH+SUNpAajW724Nv2Wvhif6sFAgMBAAGjge4wgeswHQYDVR0OBBYEFJaffLvGbxe9WT9S1wob7BDWZJRrMIG7BgNVHSMEgbMwgbCAFJaffLvGbxe9WT9S1wob7BDWZJRroYGUpIGRMIGOMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExFjAUBgNVBAcTDU1vdW50YWluIFZpZXcxFDASBgNVBAoTC1BheVBhbCBJbmMuMRMwEQYDVQQLFApsaXZlX2NlcnRzMREwDwYDVQQDFAhsaXZlX2FwaTEcMBoGCSqGSIb3DQEJARYNcmVAcGF5cGFsLmNvbYIBADAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBBQUAA4GBAIFfOlaagFrl71+jq6OKidbWFSE+Q4FqROvdgIONth+8kSK//Y/4ihuE4Ymvzn5ceE3S/iBSQQMjyvb+s2TWbQYDwcp129OPIbD9epdr4tJOUNiSojw7BHwYRiPh58S1xGlFgHFXwrEBb3dgNbMUa+u4qectsMAXpVHnD9wIyfmHMYIBmjCCAZYCAQEwgZQwgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tAgEAMAkGBSsOAwIaBQCgXTAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0xNTEyMTAxOTEzMzBaMCMGCSqGSIb3DQEJBDEWBBTUno4gI/mmaVaGVpgB/CWwQd3DeDANBgkqhkiG9w0BAQEFAASBgFmZ1j1Ss/FNl/JRIOakhBJEdm2KGLH0d2ewwTYIgIkEKSdc5Rg2/2xFS/dglcs5Te3R2GzaqjGlNSKldsk/MgZP/BudpHAASQ09hrfDy5TaBlRRl1Yu0WzGBKcVm/WRh0v2TVV8vBHVGiJD+aY5epgRXXI/XUKD0bp8tVV1T7LS-----END PKCS7-----
    ">
    <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
    <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
    </form>
</div>
  <h4>Previous topic</h4>
  <p class="topless"><a href="changelog-2.1.html"
                        title="previous chapter">Change history for Celery 2.1</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="changelog-1.0.html"
                        title="next chapter">Change history for Celery 1.0</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/history/changelog-2.0.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="changelog-1.0.html" title="Change history for Celery 1.0"
             >next</a> |</li>
        <li class="right" >
          <a href="changelog-2.1.html" title="Change history for Celery 2.1"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Celery 3.1.25 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >History</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../copyright.html">Copyright</a> 2009-2015, Ask Solem &amp; Contributors.
    </div>
  </body>
</html>